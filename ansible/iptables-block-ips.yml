---

- hosts: elastic
  become: true

  tasks:
    - iptables:
        chain: INPUT
        source: "{{ item }}"
        jump: ACCEPT
      become: yes
      loop:
        # ES nodes
        - 192.46.232.113
        - 194.233.160.227
        - 194.233.161.92
        # Macbook Dmytro
        - 77.120.203.142
        # Laptop Denys
        - 176.120.103.23
        - 176.120.105.0
        # VMs
        - 159.65.114.20
        - 159.89.105.173
        - 159.89.96.169
        - 159.89.102.127
        - 159.89.27.159
        - 139.59.209.223
        - 159.89.100.98
        - 159.89.110.78
        - 46.101.230.30
        - 165.227.158.195
        - 138.68.88.105
        - 138.68.76.28
        - 138.68.71.92
        - 138.68.89.142
        - 139.59.210.12
        - 139.59.153.208
        - 139.59.210.32
        - 138.68.85.255
        - 159.89.17.88
        - 159.89.26.30

    - iptables:
        chain: OUTPUT
        destination: "{{ item }}"
        jump: ACCEPT
      become: yes
      loop:
        # ES nodes
        - 192.46.232.113
        - 194.233.160.227
        - 194.233.161.92
        # Macbook Dmytro
        - 77.120.203.142
        # Laptop Denys
        - 176.120.103.23
        - 176.120.105.0
        # VMs
        - 159.65.114.20
        - 159.89.105.173
        - 159.89.96.169
        - 159.89.102.127
        - 159.89.27.159
        - 139.59.209.223
        - 159.89.100.98
        - 159.89.110.78
        - 46.101.230.30
        - 165.227.158.195
        - 138.68.88.105
        - 138.68.76.28
        - 138.68.71.92
        - 138.68.89.142
        - 139.59.210.12
        - 139.59.153.208
        - 139.59.210.32
        - 138.68.85.255
        - 159.89.17.88
        - 159.89.26.30

    - iptables:
        chain: INPUT
        policy: DROP
      become: yes

    - iptables:
        chain: OUTPUT
        policy: DROP
      become: yes